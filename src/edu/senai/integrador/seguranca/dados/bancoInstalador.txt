CREATE DATABASE IF NOT EXISTS `projeto_integrador`;
USE `projeto_integrador`;
CREATE TABLE IF NOT EXISTS `projeto_integrador`.`Pessoa` ( `CPF` VARCHAR(11) NOT NULL, `nome` VARCHAR(45) NOT NULL, `estadoCivil` VARCHAR(45) NOT NULL, `sexo` TINYINT(1) NOT NULL, `dataNascimento` DATE NOT NULL, `ativo` INT NOT NULL, UNIQUE INDEX `CPF_UNIQUE` (`CPF` ASC) , PRIMARY KEY (`CPF`)) ENGINE = InnoDB;
CREATE TABLE IF NOT EXISTS `projeto_integrador`.`Aluno` (`CPF` VARCHAR(11) NOT NULL, `altura` FLOAT NULL, `peso` FLOAT NULL, UNIQUE INDEX `CPFAluno_UNIQUE` (`CPF` ASC), CONSTRAINT `fk_aluno_cpf` FOREIGN KEY (`CPF`) REFERENCES `projeto_integrador`.`Pessoa` (`CPF`) ON DELETE CASCADE ON UPDATE CASCADE) ENGINE = InnoDB;
CREATE TABLE IF NOT EXISTS `projeto_integrador`.`Funcionario` ( `CPF` VARCHAR(11) NOT NULL, `escolaridade` VARCHAR(45) NOT NULL, `CTPS` VARCHAR(20) NOT NULL, UNIQUE INDEX `CPFFuncionario_UNIQUE` (`CPF` ASC), CONSTRAINT `fk_funcionario_pessoa` FOREIGN KEY (`CPF`) REFERENCES `projeto_integrador`.`Pessoa` (`CPF`) ON DELETE CASCADE ON UPDATE CASCADE) ENGINE = InnoDB;
CREATE TABLE IF NOT EXISTS `projeto_integrador`.`CEP` (`CEP` VARCHAR(8) NOT NULL, PRIMARY KEY (`CEP`), UNIQUE INDEX `CEP_UNIQUE` (`CEP` ASC) ) ENGINE = InnoDB;
CREATE TABLE IF NOT EXISTS `projeto_integrador`.`Logradouro` ( `logradouro` VARCHAR(3) NOT NULL, PRIMARY KEY (`logradouro`), UNIQUE INDEX `logradouro_UNIQUE` (`logradouro` ASC) ) ENGINE = InnoDB;
CREATE TABLE IF NOT EXISTS `projeto_integrador`.`Via` ( `via` VARCHAR(50) NOT NULL, PRIMARY KEY (`via`), UNIQUE INDEX `via_UNIQUE` (`via` ASC) ) ENGINE = InnoDB;
CREATE TABLE IF NOT EXISTS `projeto_integrador`.`Cidade` ( `Cidade` VARCHAR(45) NOT NULL, PRIMARY KEY (`Cidade`), UNIQUE INDEX `Cidade_UNIQUE` (`Cidade` ASC) ) ENGINE = InnoDB;
CREATE TABLE IF NOT EXISTS `projeto_integrador`.`Estado` ( `estado` VARCHAR(2) NOT NULL, PRIMARY KEY (`estado`), UNIQUE INDEX `estado_UNIQUE` (`estado` ASC) ) ENGINE = InnoDB;
CREATE TABLE IF NOT EXISTS `projeto_integrador`.`Endereco` ( `CPF` VARCHAR(11) NULL, `logradouro` VARCHAR(3) NULL, `via` VARCHAR(50) NULL, `numero` INT NULL, `complemento` VARCHAR(10) NULL, `cidade` VARCHAR(45) NULL, `estado` VARCHAR(2) NULL, `CEP` VARCHAR(8) NULL, INDEX `fk_endereco_pessoa_idx` (`CPF` ASC) , INDEX `fk_endereco_logradouro_idx` (`logradouro` ASC) , INDEX `fk_endereco_via_idx` (`via` ASC) , INDEX `fk_endereco_cidade_idx` (`cidade` ASC) , INDEX `fk_endereco_estado_idx` (`estado` ASC) , INDEX `fk_endereco_cep_idx` (`CEP` ASC) , CONSTRAINT `fk_endereco_pessoa` FOREIGN KEY (`CPF`) REFERENCES `projeto_integrador`.`Pessoa` (`CPF`) ON DELETE CASCADE ON UPDATE CASCADE, CONSTRAINT `fk_endereco_logradouro` FOREIGN KEY (`logradouro`) REFERENCES `projeto_integrador`.`Logradouro` (`logradouro`) ON DELETE CASCADE ON UPDATE CASCADE, CONSTRAINT `fk_endereco_via` FOREIGN KEY (`via`) REFERENCES `projeto_integrador`.`Via` (`via`) ON DELETE CASCADE ON UPDATE CASCADE, CONSTRAINT `fk_endereco_cidade` FOREIGN KEY (`cidade`) REFERENCES `projeto_integrador`.`Cidade` (`Cidade`)    ON DELETE CASCADE    ON UPDATE CASCADE,  CONSTRAINT `fk_endereco_estado`    FOREIGN KEY (`estado`)   REFERENCES `projeto_integrador`.`Estado` (`estado`)    ON DELETE CASCADE    ON UPDATE CASCADE,  CONSTRAINT `fk_endereco_cep`    FOREIGN KEY (`CEP`) REFERENCES `projeto_integrador`.`CEP` (`CEP`) ON DELETE CASCADE ON UPDATE CASCADE) ENGINE = InnoDB;
CREATE TABLE IF NOT EXISTS `projeto_integrador`.`TelefoneMovel` ( `CPF` VARCHAR(11) NULL, `numero` VARCHAR(11) NULL, INDEX `fk_movel_pessoa_idx` (`CPF` ASC) , CONSTRAINT `fk_movel_pessoa` FOREIGN KEY (`CPF`) REFERENCES `projeto_integrador`.`Pessoa` (`CPF`) ON DELETE CASCADE ON UPDATE CASCADE)ENGINE = InnoDB;
CREATE TABLE IF NOT EXISTS `projeto_integrador`.`TelefoneFixo` ( `CPF` VARCHAR(11) NULL, `numero` VARCHAR(11) NULL, CONSTRAINT `fk_contato_pessoa` FOREIGN KEY (`CPF`) REFERENCES `projeto_integrador`.`Pessoa` (`CPF`) ON DELETE CASCADE ON UPDATE CASCADE) ENGINE = InnoDB;
CREATE TABLE IF NOT EXISTS `projeto_integrador`.`Email` ( `CPF` VARCHAR(11) NULL, `email` VARCHAR(100) NULL, INDEX `fk_email_pessoa_idx` (`CPF` ASC) , CONSTRAINT `fk_email_pessoa` FOREIGN KEY (`CPF`) REFERENCES `projeto_integrador`.`Pessoa` (`CPF`) ON DELETE CASCADE ON UPDATE CASCADE) ENGINE = InnoDB;
CREATE TABLE IF NOT EXISTS `projeto_integrador`.`Login` ( `usuario` VARCHAR(30) NOT NULL, `senha` VARCHAR(20) NOT NULL, `CPFAluno` VARCHAR(11) NULL, `CPFFuncionario` VARCHAR(11) NULL, INDEX `fk_login_aluno_idx` (`CPFAluno` ASC) , INDEX `fk_login_funcionario_idx` (`CPFFuncionario` ASC) , PRIMARY KEY (`usuario`), UNIQUE INDEX `usuario_UNIQUE` (`usuario` ASC) , CONSTRAINT `fk_login_aluno` FOREIGN KEY (`CPFAluno`) REFERENCES `projeto_integrador`.`Aluno` (`CPF`) ON DELETE CASCADE ON UPDATE CASCADE, CONSTRAINT `fk_login_funcionario` FOREIGN KEY (`CPFFuncionario`) REFERENCES `projeto_integrador`.`Funcionario` (`CPF`) ON DELETE CASCADE ON UPDATE CASCADE) ENGINE = InnoDB;
CREATE TABLE IF NOT EXISTS `projeto_integrador`.`Modalidade` ( `idModalidade` VARCHAR(50) NOT NULL, `semana` CHAR(7) NULL, `minimoParticipantes` INT NULL, `ativo` CHAR(1) NOT NULL, PRIMARY KEY (`idModalidade`)) ENGINE = InnoDB;
CREATE TABLE IF NOT EXISTS `projeto_integrador`.`Turma` ( `idTurma` INT NOT NULL, `idModalidade` VARCHAR(50) NULL, `horarioInicio` TIME NULL, `duracao` FLOAT NULL, PRIMARY KEY (`idTurma`), INDEX `fk_turma_modalidade_idx` (`idModalidade` ASC) , CONSTRAINT `fk_turma_modalidade`  FOREIGN KEY (`idModalidade`) REFERENCES `projeto_integrador`.`Modalidade` (`idModalidade`) ON DELETE CASCADE ON UPDATE CASCADE) ENGINE = InnoDB;
CREATE TABLE IF NOT EXISTS `projeto_integrador`.`Participantes` ( `idTurma` INT NOT NULL, `CPFAluno` VARCHAR(11) NULL, `CPFFuncionario` VARCHAR(11) NULL, INDEX `fk_cpf_aluno_idx` (`CPFAluno` ASC) , INDEX `fk_cpf_funcionario_idx` (`CPFFuncionario` ASC) , INDEX `fk_participantes_turma_idx` (`idTurma` ASC) , CONSTRAINT `fk_cpf_aluno` FOREIGN KEY (`CPFAluno`) REFERENCES `projeto_integrador`.`Aluno` (`CPF`) ON DELETE CASCADE ON UPDATE CASCADE, CONSTRAINT `fk_cpf_funcionario` FOREIGN KEY (`CPFFuncionario`) REFERENCES `projeto_integrador`.`Funcionario` (`CPF`) ON DELETE CASCADE ON UPDATE CASCADE, CONSTRAINT `fk_participantes_turma` FOREIGN KEY (`idTurma`) REFERENCES `projeto_integrador`.`Turma` (`idTurma`) ON DELETE CASCADE ON UPDATE CASCADE) ENGINE = InnoDB;